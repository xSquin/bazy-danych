-- zad 1 --
SELECT RANK() OVER (ORDER BY pensja DESC), CONCAT(FIRST_NAME,' ',LAST_NAME) AS NAME, pensja FROM EMPLOYEE;
-- zad 2 --
SELECT CONCAT(FIRST_NAME,' ',LAST_NAME) AS NAME, pensja, SUM(pensja) OVER() FROM EMPLOYEE;
-- zad 3 --
SELECT LAST_NAME, PRODUCT_NAME, SUM(AMOUNT*SELL_PRICE) OVER(PARTITION BY EMPLOYEE_ID) AS WARTOSC_SPRZEDAZY, RANK() OVER(ORDER BY AMOUNT*SELL_PRICE  DESC) AS RANKING FROM EMPLOYEE JOIN `ORDER` ON `ORDER`.EMPLOYEE_ID = EMPLOYEE.EMPLOYEE_NAME JOIN ORDER_POSITION ON OR ER_POSITION.ORDER_ID = `ORDER`.ORDER_ID JOIN PRODUCT ON PRODUCT.PRODUCT_ID = ORDER_POSITION.PRODUCT_ID;
-- zad 4 --
SELECT LAST_NAME, PRODUCT_NAME, SELL_PRICE, COUNT(*) OVER(PARTITION BY PRODUCT.PRODUCT_ID, `ORDER`.ORDER_DATE) AS LICZBA_TRANSAKCJI, SUM(AMOUNT*SELL_PRICE) OVER(PARTITION BY PRODUCT.PRODUCT_ID, `ORDER`.ORDER_DATE) AS SUMA, LAG(SELL_PRICE) OVER(PARTITION BY PRODUCT.PRODUCT_ID ORDER BY `ORDER`.ORDER_DATE) AS POPRZEDNIE, LEAD(SELL_PRICE) OVER(PARTITION BY PRODUCT.PRODUCT_ID ORDER BY `ORDER`.ORDER_DATE) AS NASTEPNE FROM ORDER_POSITION JOIN `ORDER` ON `ORDER`.ORDER_ID = ORDER_POSITION.ORDER_ID JOIN EMPLOYEE ON EMPLOYEE.EMPLOYEE_NAME = `ORDER`.EMPLOYEE_ID JOIN PRODUCT ON PRODUCT.PRODUCT_ID = ORDER_POSITION.PRODUCT_ID;
-- zad 5 --
