-- zad 1 --
1. 
SELECT AVG(pensja) FROM EMPLOYEE;
2. 
SELECT JOB_POSITION_ID, AVG(pensja), COUNT(*) FROM EMPLOYEE GROUP BY JOB_POSITION_ID;
3. 
SELECT DEPARTMENT_ID, AVG(2025 - YEAR(BIRTH_DATE)) AS 'SREDNI WIEK' FROM
EMPLOYEE GROUP BY DEPARTMENT_ID;
-- zad 2 --
1. 
SELECT DEPARTMENT_ID, SUM(pensja) FROM EMPLOYEE GROUP BY DEPARTMENT_ID;
2. 
SELECT JOB_POSITION_ID, AVG(pensja) FROM EMPLOYEE GROUP BY JOB_POSITION_ID  HAVING COUNT(JOB_POSITION_ID) >= 3 AND AVG(pensja) > 3000;
3. 
SELECT COUNT(DISTINCT pensja) FROM EMPLOYEE GROUP BY DEPARTMENT_ID HAVING COUNT(*) > 4 ORDER BY COUNT(DISTINCT pensja) ASC;
-- zad 3 -- 
1.
CREATE TABLE DEPARTMENT AS SELECT * FROM company_2025.DEPARTMENT;
CREATE TABLE JOB_POSITION AS SELECT * FROM company_2025.JOB_POSITION;
2.
SELECT DEPARTMENT.DEPARTMENT_NAME, COUNT(*) AS 'LICZBA PRACOWNIKOW' FROM EMPLOYEE JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID GROUP BY DEPARTMENT_NAME;
3.
SELECT DEPARTMENT_NAME, CONCAT(EMPLOYEE.FIRST_NAME,' ',EMPLOYEE.LAST_NAME) AS 'IMIE I NAZWISKO' FROM DEPARTMENT JOIN EMPLOYEE ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID;
-- zad 4 --
1.
SELECT LAST_NAME, DEPARTMENT.DEPARTMENT_NAME FROM EMPLOYEE NATURAL JOIN DEPARTMENT WHERE BIRTH_DATE LIKE '199%';
2.
SELECT FIRST_NAME, LAST_NAME, BIRTH_DATE FROM EMPLOYEE JOIN JOB_POSITION
ON JOB_POSITION.JOB_POSITION_ID = EMPLOYEE.JOB_POSITION_ID WHERE POSITION_NAME
= 'Magazynier' ORDER BY BIRTH_DATE DESC LIMIT 5;
3.
SELECT A.SHORT_NAME, B.SHORT_NAME FROM CLIENT A JOIN CLIENT B ON A.CLIENT_ID + 5 = B.CLIENT_ID ORDER BY A.CLIENT_ID;
-- zad 5 --
1.
SELECT JOB_POSITION_ID, AVG(pensja) FROM EMPLOYEE JOIN DEPARTMENT ON DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID WHERE DEPARTMENT_NAME NOT IN('IT','HR') GROUP BY JOB_POSITION_ID HAVING COUNT(*) > 3;
2.
SELECT FIRST_NAME, LAST_NAME, BIRTH_DATE, DEPARTMENT_ID FROM EMPLOYEE JOIN( SELECT JOB_POSITION_ID, MIN(BIRTH_DATE) AS 'min', MAX(BIRTH_DATE) AS 'max' FROM EMPLOYEE GROUP BY JOB_POSITION_ID) X ON X.JOB_POSITION_ID = EMPLOYEE.JOB_POSTION_ID AND (EMPLOYEE.BIRTH_DATE = X.min OR EMPLOYEE.BIRTH_DATE = X.max);

